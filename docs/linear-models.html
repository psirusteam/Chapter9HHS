<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.3 Linear models | CHAPTER 9: ANALYSIS OF HOUSEHOLD SURVEY DATA</title>
  <meta name="description" content="Chapter 9 of UN Household Survey Handbook" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="4.3 Linear models | CHAPTER 9: ANALYSIS OF HOUSEHOLD SURVEY DATA" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapter 9 of UN Household Survey Handbook" />
  <meta name="github-repo" content="psirusteam/Chapter9HHS" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.3 Linear models | CHAPTER 9: ANALYSIS OF HOUSEHOLD SURVEY DATA" />
  
  <meta name="twitter:description" content="Chapter 9 of UN Household Survey Handbook" />
  

<meta name="author" content="Andrés Gutiérrez, Pedro Luis do Nascimento Silva" />


<meta name="date" content="2024-10-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="some-inferential-approaches-to-modelling-data.html"/>
<link rel="next" href="logistic-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Chapter 9 of UN Household Survey Handbook.</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="the-golden-pair-sample-design-and-estimator.html"><a href="the-golden-pair-sample-design-and-estimator.html"><i class="fa fa-check"></i><b>1</b> The golden pair: sample design and estimator</a>
<ul>
<li class="chapter" data-level="1.1" data-path="parameters-and-estimators.html"><a href="parameters-and-estimators.html"><i class="fa fa-check"></i><b>1.1</b> Parameters and estimators</a></li>
<li class="chapter" data-level="1.2" data-path="uncertainty-in-household-surveys.html"><a href="uncertainty-in-household-surveys.html"><i class="fa fa-check"></i><b>1.2</b> Uncertainty in household surveys</a></li>
<li class="chapter" data-level="1.3" data-path="ultimate-cluster-method.html"><a href="ultimate-cluster-method.html"><i class="fa fa-check"></i><b>1.3</b> Ultimate Cluster Method</a></li>
<li class="chapter" data-level="1.4" data-path="bootstrap-method.html"><a href="bootstrap-method.html"><i class="fa fa-check"></i><b>1.4</b> Bootstrap Method</a></li>
<li class="chapter" data-level="1.5" data-path="using-software-to-generate-valid-inferences.html"><a href="using-software-to-generate-valid-inferences.html"><i class="fa fa-check"></i><b>1.5</b> Using software to generate valid inferences</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="descriptive-parameters.html"><a href="descriptive-parameters.html"><i class="fa fa-check"></i><b>2</b> Descriptive parameters</a>
<ul>
<li class="chapter" data-level="2.1" data-path="frequencies.html"><a href="frequencies.html"><i class="fa fa-check"></i><b>2.1</b> Frequencies</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="frequencies.html"><a href="frequencies.html#point-estimation"><i class="fa fa-check"></i><b>2.1.1</b> Point Estimation</a></li>
<li class="chapter" data-level="2.1.2" data-path="frequencies.html"><a href="frequencies.html#size-estimates"><i class="fa fa-check"></i><b>2.1.2</b> Size Estimates</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="totals-means-proportions-and-ratios.html"><a href="totals-means-proportions-and-ratios.html"><i class="fa fa-check"></i><b>2.2</b> Totals, means, proportions, and ratios</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="totals-means-proportions-and-ratios.html"><a href="totals-means-proportions-and-ratios.html#estimating-totals"><i class="fa fa-check"></i><b>2.2.1</b> Estimating totals</a></li>
<li class="chapter" data-level="2.2.2" data-path="totals-means-proportions-and-ratios.html"><a href="totals-means-proportions-and-ratios.html#estimating-averages"><i class="fa fa-check"></i><b>2.2.2</b> Estimating averages</a></li>
<li class="chapter" data-level="2.2.3" data-path="totals-means-proportions-and-ratios.html"><a href="totals-means-proportions-and-ratios.html#estimating-proportions"><i class="fa fa-check"></i><b>2.2.3</b> Estimating proportions</a></li>
<li class="chapter" data-level="2.2.4" data-path="totals-means-proportions-and-ratios.html"><a href="totals-means-proportions-and-ratios.html#estimating-ratios"><i class="fa fa-check"></i><b>2.2.4</b> Estimating ratios</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="variances-and-standard-deviations.html"><a href="variances-and-standard-deviations.html"><i class="fa fa-check"></i><b>2.3</b> Variances and standard deviations</a></li>
<li class="chapter" data-level="2.4" data-path="correlations.html"><a href="correlations.html"><i class="fa fa-check"></i><b>2.4</b> Correlations</a></li>
<li class="chapter" data-level="2.5" data-path="percentiles-and-inequality-measures.html"><a href="percentiles-and-inequality-measures.html"><i class="fa fa-check"></i><b>2.5</b> Percentiles and inequality measures</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="percentiles-and-inequality-measures.html"><a href="percentiles-and-inequality-measures.html#estimating-the-gini-coefficient"><i class="fa fa-check"></i><b>2.5.1</b> Estimating the Gini coefficient</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="nso-practical-example.html"><a href="nso-practical-example.html"><i class="fa fa-check"></i><b>2.6</b> NSO – Practical example</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="associations-between-categorical-variables.html"><a href="associations-between-categorical-variables.html"><i class="fa fa-check"></i><b>3</b> Associations between categorical variables</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cross-tabulations-and-contingency-tables.html"><a href="cross-tabulations-and-contingency-tables.html"><i class="fa fa-check"></i><b>3.1</b> Cross-tabulations and contingency tables</a></li>
<li class="chapter" data-level="3.2" data-path="testing-for-independence.html"><a href="testing-for-independence.html"><i class="fa fa-check"></i><b>3.2</b> Testing for independence</a></li>
<li class="chapter" data-level="3.3" data-path="tests-for-group-comparisons.html"><a href="tests-for-group-comparisons.html"><i class="fa fa-check"></i><b>3.3</b> Tests for group comparisons</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="tests-for-group-comparisons.html"><a href="tests-for-group-comparisons.html#hypothesis-test-for-the-difference-of-means"><i class="fa fa-check"></i><b>3.3.1</b> Hypothesis Test for the Difference of Means</a></li>
<li class="chapter" data-level="3.3.2" data-path="tests-for-group-comparisons.html"><a href="tests-for-group-comparisons.html#contrasts"><i class="fa fa-check"></i><b>3.3.2</b> Contrasts</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="nso-practical-example-1.html"><a href="nso-practical-example-1.html"><i class="fa fa-check"></i><b>3.4</b> NSO – Practical example</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regression-modelling-survey-data.html"><a href="regression-modelling-survey-data.html"><i class="fa fa-check"></i><b>4</b> Regression: modelling survey data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="to-weight-or-not-to-weight.html"><a href="to-weight-or-not-to-weight.html"><i class="fa fa-check"></i><b>4.1</b> To weight or not to weight?</a></li>
<li class="chapter" data-level="4.2" data-path="some-inferential-approaches-to-modelling-data.html"><a href="some-inferential-approaches-to-modelling-data.html"><i class="fa fa-check"></i><b>4.2</b> Some inferential approaches to modelling data</a></li>
<li class="chapter" data-level="4.3" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>4.3</b> Linear models</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="linear-models.html"><a href="linear-models.html#basic-definitions"><i class="fa fa-check"></i><b>4.3.1</b> Basic Definitions</a></li>
<li class="chapter" data-level="4.3.2" data-path="linear-models.html"><a href="linear-models.html#estimation-of-parameters-in-a-regression-model-with-complex-samples"><i class="fa fa-check"></i><b>4.3.2</b> Estimation of Parameters in a Regression Model with Complex Samples</a></li>
<li class="chapter" data-level="4.3.3" data-path="linear-models.html"><a href="linear-models.html#the-pfeffermann-weighting-approach"><i class="fa fa-check"></i><b>4.3.3</b> The Pfeffermann Weighting Approach</a></li>
<li class="chapter" data-level="4.3.4" data-path="linear-models.html"><a href="linear-models.html#model-diagnostics"><i class="fa fa-check"></i><b>4.3.4</b> Model Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="logistic-models.html"><a href="logistic-models.html"><i class="fa fa-check"></i><b>4.4</b> Logistic models</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="logistic-models.html"><a href="logistic-models.html#logistic-regression-model-for-proportions"><i class="fa fa-check"></i><b>4.4.1</b> Logistic Regression Model for Proportions</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="nso-practical-example-2.html"><a href="nso-practical-example-2.html"><i class="fa fa-check"></i><b>4.5</b> NSO – Practical example</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>5</b> Data visualization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="weighted-histograms.html"><a href="weighted-histograms.html"><i class="fa fa-check"></i><b>5.1</b> Weighted Histograms</a></li>
<li class="chapter" data-level="5.2" data-path="bar-charts.html"><a href="bar-charts.html"><i class="fa fa-check"></i><b>5.2</b> Bar Charts</a></li>
<li class="chapter" data-level="5.3" data-path="box-plots.html"><a href="box-plots.html"><i class="fa fa-check"></i><b>5.3</b> Box Plots</a></li>
<li class="chapter" data-level="5.4" data-path="scatter-plots.html"><a href="scatter-plots.html"><i class="fa fa-check"></i><b>5.4</b> Scatter Plots</a></li>
<li class="chapter" data-level="5.5" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>5.5</b> Maps</a></li>
<li class="chapter" data-level="5.6" data-path="nso-practical-example-3.html"><a href="nso-practical-example-3.html"><i class="fa fa-check"></i><b>5.6</b> NSO – Practical example</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="other-modeling-scenarios.html"><a href="other-modeling-scenarios.html"><i class="fa fa-check"></i><b>6</b> Other modeling scenarios</a>
<ul>
<li class="chapter" data-level="6.1" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>6.1</b> Multilevel models</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="multilevel-models.html"><a href="multilevel-models.html#model-with-random-intercept"><i class="fa fa-check"></i><b>6.1.1</b> Model with Random Intercept</a></li>
<li class="chapter" data-level="6.1.2" data-path="multilevel-models.html"><a href="multilevel-models.html#model-with-random-slope"><i class="fa fa-check"></i><b>6.1.2</b> Model with Random Slope</a></li>
<li class="chapter" data-level="6.1.3" data-path="multilevel-models.html"><a href="multilevel-models.html#model-with-random-intercept-and-slope"><i class="fa fa-check"></i><b>6.1.3</b> Model with Random Intercept and Slope</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="survival-models.html"><a href="survival-models.html"><i class="fa fa-check"></i><b>6.2</b> Survival models</a></li>
<li class="chapter" data-level="6.3" data-path="loglinear-models-for-contingency-tables.html"><a href="loglinear-models-for-contingency-tables.html"><i class="fa fa-check"></i><b>6.3</b> Loglinear models for contingency tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a Chapter 9 of UN Household Survey Handbook. </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CHAPTER 9: ANALYSIS OF HOUSEHOLD SURVEY DATA</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-models" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Linear models<a href="linear-models.html#linear-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="basic-definitions" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Basic Definitions<a href="linear-models.html#basic-definitions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As noted by <span class="citation">Heeringa, West, and Berglund (<a href="#ref-Heeringa_West_Berglund_2017">2017a</a>)</span>, the first authors to empirically discuss the impact of complex sampling designs on regression model inferences were <span class="citation">Kish and Frankel (<a href="#ref-kish1974inference">1974</a>)</span>. Later, <span class="citation">Fuller (<a href="#ref-fuller1975regression">1975</a>)</span> developed a variance estimator for regression model parameters based on Taylor linearization with unequal weighting of observations under stratified and two-stage sampling designs.</p>
<p>As is well known, the use of regression model theory requires certain statistical assumptions to be met, which can sometimes be challenging to verify in practice. In this regard, <span class="citation">Shah, Holt, and Folsom (<a href="#ref-shah1977inference">1977</a>)</span> discuss some aspects related to the violation of these assumptions and provide appropriate methods for making inferences about the estimated parameters of linear regression models using survey data.</p>
<p>Similarly, <span class="citation">David A. Binder (<a href="#ref-binder1983variances">1983a</a>)</span> obtained the sampling distributions of estimators for regression parameters in finite populations and related variance estimators in the context of complex samples. <span class="citation">Skinner, Holt, and Smith (<a href="#ref-skinner1989analysis">1989</a>)</span> studied the properties of variance estimators for regression coefficients under complex sample designs. Later, <span class="citation">Fuller (<a href="#ref-fuller2002regression">2002</a>)</span> provided a summary of estimation methods for regression models containing information related to complex samples. Finally, <span class="citation">Pfeffermann (<a href="#ref-pfeffermann2011modelling">2011</a>)</span> discussed various approaches to fitting linear regression models to complex survey data, presenting empirical support for the use of the “<em>q-weighted</em>” method, which is recommended in this document.</p>
<p>A simple linear regression model is defined as <span class="math inline">\(y=\beta_{0}+\beta_{1}x+\varepsilon\)</span>, where <span class="math inline">\(y\)</span> represents the dependent variable, <span class="math inline">\(x\)</span> is the independent variable, and <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{1}\)</span> are the model parameters. The variable <span class="math inline">\(\varepsilon\)</span> is known as the random error of the model and is defined as <span class="math inline">\(\varepsilon=y-\hat{y}=y-\beta_{0}+\beta_{1}x\)</span>.</p>
<p>Generalizing the previous model, multiple linear regression models are defined by allowing the dependent variable to interact with more than two variables, as presented below:</p>
<p><span class="math display">\[
y  =  \boldsymbol{x}\boldsymbol{\beta}+\varepsilon
  =  \sum_{j=0}^{p}\beta_{j}x_{j}+\varepsilon
=  \beta_{0}+\beta_{1}x_{1}+\cdots+\beta_{p}x_{p}+\varepsilon
\]</span></p>
<p>Another way to write the multiple regression model is:</p>
<p><span class="math display">\[
y_{i}  =  x_{i}\boldsymbol{\beta}+\varepsilon_{i}
\]</span></p>
<p>Where, <span class="math inline">\(x_{i}=\left[1\,x_{1i}\,\ldots\,x_{pi}\right]\)</span> and <span class="math inline">\(\boldsymbol{\beta}^{T}=\left[\beta_{0}\,\,\beta_{1}\,\,\ldots\,\,\beta_{p}\right]\)</span>.</p>
<p>The subscript <span class="math inline">\(i\)</span> refers to the sample element or respondent in the dataset. <span class="citation">Heeringa, West, and Berglund (<a href="#ref-Heeringa_West_Berglund_2017">2017a</a>)</span> present some considerations for regression models, which are described below:</p>
<ul>
<li><span class="math inline">\(E\left(\varepsilon_{i}\mid x_{i}\right)=0\)</span>, meaning that the expected value of the residuals conditioned on the covariates is zero.</li>
<li><span class="math inline">\(Var\left(\varepsilon_{i}\mid x_{i}\right)=\sigma_{y,x}^{2}\)</span> (homogeneity of variance), meaning that the variance of the residuals conditioned on the covariates is constant.</li>
<li><span class="math inline">\(\varepsilon_{i}\mid x_{i}\sim N\left(0,\,\sigma_{y,x}^{2}\right)\)</span> (normality of errors), meaning that the residuals conditioned on the covariates follow a normal distribution. This property also extends to the response variable <span class="math inline">\(y_{i}\)</span>.</li>
<li><span class="math inline">\(cov\left(\varepsilon_{i},\,\varepsilon_{j}\mid x_{i},x_{j}\right)\)</span> (independence of residuals), meaning that the residuals in different observed units are not correlated with the values given by their predictor variables.</li>
</ul>
<p>Once the linear regression model and its assumptions are defined, it can be deduced that the best unbiased linear estimator is defined as the expected value of the dependent variable conditioned on the independent variables <span class="math inline">\(x\)</span>, as:</p>
<p><span class="math display">\[
E\left(y\mid x\right)=\hat{\beta}_{0}+\hat{\beta_{1}}x_{1}+\hat{\beta}_{2}x_{2}+\cdots+\hat{\beta}_{p}x_{p}
\]</span></p>
<p><span class="math display">\[
\hat{y}  =  E\left(y\mid x\right)
=  E\left(\boldsymbol{x}\boldsymbol{\beta}\right)+E\left(\varepsilon\right)
=  \boldsymbol{x}\boldsymbol{\beta}+0
  =  \beta_{0}+\beta_{1}x_{1}+\cdots+\beta_{p}x_{p}
\]</span></p>
<p>Additionally,</p>
<p><span class="math display">\[
var\left(y_{i}\mid x_{i}\right)  =  \sigma_{y,x}^{2}
\]</span></p>
<p>It is also established that:</p>
<p><span class="math display">\[
cov\left(y_{i},y_{j}\mid x_{i},x_{j}\right)  = 0
\]</span></p>
<p>Thus, the response variable has the following distribution:</p>
<p><span class="math display">\[
y_{i}  \sim  N\left(x_{i}\boldsymbol{\beta},\sigma_{y,x}^{2}\right)
\]</span></p>
</div>
<div id="estimation-of-parameters-in-a-regression-model-with-complex-samples" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Estimation of Parameters in a Regression Model with Complex Samples<a href="linear-models.html#estimation-of-parameters-in-a-regression-model-with-complex-samples" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Once the assumptions of the model and the distributional characteristics of the errors are established, the next step is the process of parameter estimation. As an illustrative and introductory example, if instead of observing a sample of size <span class="math inline">\(n\)</span> from the <span class="math inline">\(N\)</span> elements of the population, a complete census had been conducted, the finite population regression parameter <span class="math inline">\(\beta_{1}\)</span> could be calculated as follows:</p>
<p><span class="math display">\[
\beta_{1}  =  \frac{ \sum_{i=1}^{N}\left(X_{i}-\bar{X}\right)\left(Y_{i}-\bar{Y}\right)}{\sum_{i=1}^{N}\left(X_{i}-\bar{X}\right)^{2}}
\]</span></p>
<p>Now, when estimating the parameters of a linear regression model considering that the observed information comes from surveys with complex samples, the standard approach to estimating regression coefficients and their standard errors is altered. The main reason for this change is that data collected through a complex survey generally does not have an identical distribution, and the assumption of independence cannot be maintained since the sample design is constructed with dependencies (as most complex designs include stratification, clustering, unequal selection probabilities, etc.).</p>
<p>In this context, when fitting regression models with such datasets, using conventional estimators derived from traditional methods (such as maximum likelihood, for example) will induce bias because these methods assume the data are independently and identically distributed and come from a specific probability distribution (binomial, Poisson, exponential, normal, etc.). Instead, according to <span class="citation">Wolter (<a href="#ref-Wolter_2007">2007</a>)</span>, robust non-parametric methods based on Taylor linearization or variance estimation methods using replication (Jackknife, bootstrapping, etc.) are used to eliminate bias by including the sampling design in the analyses.</p>
<p>For illustrative purposes, the estimation of the parameter <span class="math inline">\(\beta_{1}\)</span> and its variance for a simple linear regression will be shown. The extension to multiple regression parameter estimation is algebraically complex and beyond the scope of this book. Below is the estimation of the slope and its variance in a simple linear regression model:</p>
<p><span class="math display">\[
\hat{\beta_{1}} = \frac{\sum_{h}^{H}\sum_{\alpha}^{a_{h}}\sum_{i=1}^{n_{h\alpha}}\omega_{h\alpha i}\left(y_{h\alpha i}-\hat{\bar{y}}_{\omega}\right)\left(x_{h\alpha i}-\hat{\bar{x}}_{\omega}\right)}{\sum_{h}^{H}\sum_{\alpha}^{a_{h}}\sum_{i=1}^{n_{h\alpha}}\omega_{h\alpha i}\left(x_{h\alpha i}-\hat{\bar{x}}_{\omega}\right)^{2}}
\]</span></p>
<p>As can be seen in the above equation, the parameter estimator is a ratio of totals; therefore, its variance is given by:</p>
<p><span class="math display">\[
var\left(\hat{\beta_{1}}\right)  =  \frac{var\left(\hat{t}_{xy}\right)+\hat{\beta}_{1}^{2}var\left(\hat{t}_{x^{2}}\right)-2\hat{\beta}_{1}cov\left(\hat{t}_{xy},\hat{t}_{x^{2}}\right)}{\left(\hat{t}_{x^{2}}\right)^{2}}
\]</span></p>
<p>As a generalization, according to <span class="citation">Kish and Frankel (<a href="#ref-kish1974inference">1974</a>)</span>, the variance estimation of coefficients in a multiple linear regression model requires weighted totals for the squares and cross-products of all combinations of <span class="math inline">\(y\)</span> and <span class="math inline">\(x = \{1, x_{1}, \ldots, x_{p}\}\)</span>. Below is the estimation of these variances:</p>
<p><span class="math display">\[
\text{var}\left(\hat{\beta}\right) = \hat{\Sigma}\left(\hat{\beta}\right) =
\begin{bmatrix}
\text{var}\left(\hat{\beta}_{0}\right) &amp; \text{cov}\left(\hat{\beta}_{0},\hat{\beta}_{1}\right) &amp; \cdots &amp; \text{cov}\left(\hat{\beta}_{0},\hat{\beta}_{p}\right) \\
\text{cov}\left(\hat{\beta}_{0},\hat{\beta}_{1}\right) &amp; \text{var}\left(\hat{\beta}_{1}\right) &amp; \cdots &amp; \text{cov}\left(\hat{\beta}_{1},\hat{\beta}_{p}\right) \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\text{cov}\left(\hat{\beta}_{0},\hat{\beta}_{p}\right) &amp; \text{cov}\left(\hat{\beta}_{1},\hat{\beta}_{p}\right) &amp; \cdots &amp; \text{var}\left(\hat{\beta}_{p}\right)
\end{bmatrix}
\]</span></p>
</div>
<div id="the-pfeffermann-weighting-approach" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> The Pfeffermann Weighting Approach<a href="linear-models.html#the-pfeffermann-weighting-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="citation">Heeringa, West, and Berglund (<a href="#ref-Heeringa_West_Berglund_2017">2017a</a>)</span> addresses the problem of how to correctly weight regression models and whether expansion factors should be used to estimate regression coefficients when working with complex survey data. In this context, it is essential to know that two primary paradigms exist in the specialized literature:</p>
<ul>
<li><strong>The design-based approach</strong>, illustrated in this document, seeks to make inferences about the entire finite population, and the use of expansion factors ensures that regression parameter estimates are unbiased. However, using survey weights does not protect against model misspecification; if the researcher fits a poorly specified model using expansion factors, unbiased estimates of the regression parameters in a model that does not correctly describe the relationships in the finite population are being computed.</li>
<li><strong>The population-based modeling approach</strong>, which argues that the use of expansion factors in estimation should not be necessary if the model is correctly specified. Under this approach, including survey weights only serves to increase the variance of the estimators, inducing larger-than-necessary standard errors.</li>
</ul>
<p>The choice between these two approaches should depend on the sensitivity of inferences to different estimation methods. It is often recommended to use statistical software to fit regression models with and without survey weights to evaluate the sensitivity of the results. If the use of weights produces substantially different estimates and conclusions, it suggests that the model may be misspecified, and weighted estimates should be preferred. However, if the use of weights does not significantly alter the regression parameter estimates and only considerably increases standard errors, it could indicate that the model is well-specified, and the use of weights may not be necessary.</p>
<p>An intermediate solution between these two approaches is given by <span class="citation">Pfeffermann (<a href="#ref-pfeffermann2011modelling">2011</a>)</span>, who proposed a variant (called the <em>q-weighted approach</em>) with a slightly different specification of the expansion factors, detailed as follows:</p>
<ol style="list-style-type: decimal">
<li>Fit a regression model to the final survey weights using the predictor variables in the regression model of interest.</li>
<li>Obtain the predicted survey weights for each case as a function of the predictor variables in the dataset.</li>
<li>Divide the survey expansion factors by the predicted values from the previous step.</li>
<li>Use the new weights obtained for fitting the regression models.</li>
</ol>
<p>This method adjusts the survey weights based on the fitted model, balancing between design-based and model-based approaches to reduce variance while accounting for complex survey design.</p>
</div>
<div id="model-diagnostics" class="section level3 hasAnchor" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Model Diagnostics<a href="linear-models.html#model-diagnostics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When fitting statistical models to household survey data, it is essential to perform quality checks to ensure the validity of the conclusions drawn. Most academic texts provide a detailed overview of the assumptions and considerations necessary for a properly defined model. Below are some of the key aspects to consider:</p>
<ul>
<li><strong>Model fit</strong>: It is important to determine whether the model provides an adequate fit to the data.</li>
<li><strong>Distribution of errors</strong>: Examine whether the errors are normally distributed.</li>
<li><strong>Error variance</strong>: Check whether the errors have constant variance.</li>
<li><strong>Error independence</strong>: Verify that the errors can be assumed to be uncorrelated.</li>
<li><strong>Influential data points</strong>: Identify if any data points have an unusually large influence on the estimated regression model.</li>
<li><strong>Outliers</strong>: Detect points that do not follow the general trend of the data, known as outliers.</li>
</ul>
<div id="coefficient-of-determination" class="section level4 hasAnchor" number="4.3.4.1">
<h4><span class="header-section-number">4.3.4.1</span> Coefficient of Determination<a href="linear-models.html#coefficient-of-determination" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The coefficient of determination, also known as the multiple correlation coefficient (<span class="math inline">\(R^{2}\)</span>), is a common measure of goodness-of-fit in a regression model. This coefficient estimates the proportion of variance in the dependent variable explained by the model and ranges between 0 and 1. A value close to 1 indicates that the model explains a large proportion of the variability, while a value near 0 suggests the opposite.</p>
<p>The calculation of this coefficient for a population is done as follows:</p>
<p><span class="math display">\[
R^{2} =  1-\frac{SSE}{SST}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(SST= \sum_{i=1}^N (y_i - \bar{y})^2\)</span>: This is the total sum of squares, representing the total variability in the dependent variable.</li>
<li><span class="math inline">\(SSE= \sum_{i=1}^N (y_i - x_i \beta)^2\)</span>: This is the sum of squared errors, representing the variability not explained by the regression model.</li>
</ul>
<p>For surveys with complex sampling designs, the weighted estimator of <span class="math inline">\(R^{2}\)</span> is given by:</p>
<p><span class="math display">\[
\widehat{R}_{\omega}^{2} = 1-\frac{\widehat{SSE}_{\omega}}{\widehat{SST}_{\omega}}
\]</span></p>
<p>Where <span class="math inline">\(\widehat{SSE}_{\omega}\)</span> is the weighted sum of squared errors, defined as:</p>
<p><span class="math display">\[
\widehat{SSE}_{\omega}  =  \sum_{h}^{H}\sum_{\alpha}^{a_{h}}\sum_{i=1}^{n_{h\alpha}}\omega_{h\alpha i}\left(y_{h\alpha i}-x_{h\alpha i}\hat{\beta}\right)^{2}
\]</span></p>
<p>This estimator adjusts the <span class="math inline">\(R^{2}\)</span> calculation to reflect the characteristics of the sampling design, such as stratification and unequal selection probabilities, ensuring that survey weights are considered when evaluating the goodness-of-fit of the model.</p>
</div>
<div id="standardized-residuals" class="section level4 hasAnchor" number="4.3.4.2">
<h4><span class="header-section-number">4.3.4.2</span> Standardized Residuals<a href="linear-models.html#standardized-residuals" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In model diagnostics, analyzing residuals is crucial. These analyses provide, under the assumption that the fitted model is adequate, an estimate of the errors. Therefore, a careful study of the residuals should help the researcher conclude whether the fitting process has not violated the assumptions or if, on the contrary, one or more assumptions are not met, requiring a review of the fitting procedure.</p>
<p>To analyze the residuals, Pearson residuals <span class="citation">(<a href="#ref-Heeringa_West_Berglund_2017">Heeringa, West, and Berglund 2017a</a>)</span> are defined as follows:</p>
<p><span class="math display">\[
r_{p_{i}}  =  \left(y_{i}-\mu_{i}\left(\hat{\beta}_{\omega}\right)\right)\sqrt{\frac{\omega_{i}}{V\left(\hat{\mu}_{i}\right)}}
\]</span></p>
<p>Where <span class="math inline">\(\mu_{i}\)</span> is the expected value of <span class="math inline">\(y_{i}\)</span>, and <span class="math inline">\(\omega_{i}\)</span> is the survey weight for the i-th individual in the complex sample design. Finally, <span class="math inline">\(V(\mu_{i})\)</span> is the variance function of the outcome. These residuals are used to perform normality and constant variance analyses.</p>
<p>If the assumption of constant variance is not met, the estimators remain unbiased and consistent, but they are no longer efficient. That is, they are no longer the best in the sense that they no longer have the smallest variance among all unbiased estimators. One way to analyze the assumption of constant variance in the errors is through graphical analysis. This is done by plotting the model residuals against <span class="math inline">\(\hat{y}\)</span> or the model residuals against <span class="math inline">\(X_{i}\)</span>. If these plots reveal any pattern other than a constant cloud of points, it can be concluded that the error variance is not constant.</p>
</div>
<div id="influential-observations" class="section level4 hasAnchor" number="4.3.4.3">
<h4><span class="header-section-number">4.3.4.3</span> Influential Observations<a href="linear-models.html#influential-observations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Another set of techniques used for model analysis involves examining influential observations. An observation is deemed influential if, when removed from the data set, it causes a significant change in the model fit. It is important to note that an influential point may or may not be an outlier. To detect influential observations, it is essential to clarify what type of influence is being sought. For instance, an observation may be influential for parameter estimation but not for error variance estimation. Below are some statistical techniques for detecting influential data points:</p>
<ol style="list-style-type: decimal">
<li><strong>Cook’s Distance</strong>: This diagnostic measures whether the i-th observation is influential in the model estimation by being far from the data’s center of mass. Various authors consider an observation influential when this value exceeds 2 or 3.</li>
<li><strong><span class="math inline">\(D_fBeta_{(i)}\)</span> Statistic</strong>: This statistic measures the change in the estimated regression coefficient vector when the observation is removed. The i-th observation is considered influential for <span class="math inline">\(B_j\)</span> if <span class="math inline">\(\mid D_{f}Betas_{\left(i\right)j}\mid \geq \frac{z}{\sqrt{n}}\)</span> with <span class="math inline">\(z = 2\)</span>. Alternatively, <span class="math inline">\(t_{0.025,n-p}/\sqrt{n}\)</span> can be used, where <span class="math inline">\(t_{0.025,n-p}\)</span> is the 97.5th percentile.</li>
<li><strong><span class="math inline">\(D_{f}Fits_{\left(i\right)}\)</span> Statistic</strong>: This statistic measures the change in the model fit when a particular observation is removed. In this case, the i-th observation is considered influential in the model fit if <span class="math inline">\(\mid DfFits\left(i\right)\mid \geq z\sqrt{\frac{p}{n}}\)</span> with <span class="math inline">\(z = 2\)</span>.</li>
</ol>
</div>
<div id="inference-on-model-parameters" class="section level4 hasAnchor" number="4.3.4.4">
<h4><span class="header-section-number">4.3.4.4</span> Inference on Model Parameters<a href="linear-models.html#inference-on-model-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Once the proper fit of the model has been evaluated using the methodologies discussed above, and the distributional properties of the errors—and consequently the response variable <span class="math inline">\(y\)</span>—have been verified, the next step is to assess whether the estimated parameters are significant. This involves determining whether the covariates used to fit the model add value in explaining and/or predicting the study variable and the phenomenon of interest.</p>
<p>Given the distributional properties of the regression coefficient estimators, a natural test statistic for evaluating the significance of these parameters is based on the t-distribution and is described as follows:</p>
<p><span class="math display">\[
t = \frac{\hat{\beta}_{k}-\beta_{k}}{se\left(\hat{\beta}_{k}\right)}\sim t_{n-p}
\]</span></p>
<p>Where <span class="math inline">\(p\)</span> is the number of model parameters and <span class="math inline">\(n\)</span> is the sample size of the survey. The test statistic above evaluates the hypotheses <span class="math inline">\(H_{0}:\beta_{k}=0\)</span> versus the alternative <span class="math inline">\(H_{1}:\beta_{k}\neq0\)</span>. Similarly, a confidence interval of <span class="math inline">\((1-\alpha)\times100\%\)</span> for <span class="math inline">\(\beta_{k}\)</span> can be constructed, as follows:</p>
<p><span class="math display">\[
\hat{\beta}_{k}\pm t_{1-\frac{\alpha}{2},\,df}\,se\left(\hat{\beta}_{k}\right)
\]</span></p>
<p>Where the degrees of freedom (<span class="math inline">\(df\)</span>) for the interval in a household survey (complex samples) is given by the number of final stage clusters minus the number of primary stage strata <span class="math inline">\(\left(df=\sum_{h}a_{h}-H\right)\)</span>.</p>
</div>
<div id="estimation-and-prediction" class="section level4 hasAnchor" number="4.3.4.5">
<h4><span class="header-section-number">4.3.4.5</span> Estimation and Prediction<a href="linear-models.html#estimation-and-prediction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>According to <span class="citation">Neter, Wasserman, and Kutner (<a href="#ref-neter1996applied">1996</a>)</span>, linear regression models are essentially used for two purposes. One is to explain the variable of interest in terms of covariates that may be found in surveys, administrative records, censuses, etc. Additionally, they are also used to predict values of the variable under study, either within the range of values collected in the sample or outside of it. The first purpose has been addressed throughout this chapter, and the second is achieved as follows:</p>
<p><span class="math display">\[
\hat{E}(y_{i}\mid\boldsymbol{x}_{obs,i})=\boldsymbol{x}_{obs,i}\hat{\boldsymbol{\beta}}
\]</span></p>
<p>Explicitly, in the model exemplified in this chapter, the expression for predictions would be:</p>
<p><span class="math display">\[
\hat{E}(y_{i}\mid\boldsymbol{x}_{obs,i})=\hat{\beta}_{0}+\hat{\beta}_{1}x_{1i}
\]</span></p>
<p>The variance of the estimation is calculated as follows:</p>
<p><span class="math display">\[
var\left(\hat{E}\left(y_{i}\mid x_{obs,i}\right)\right)
=  x&#39;_{obs,i}cov\left(\hat{\beta}\right)x{}_{obs,i}
\]</span></p>
</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-binder1983variances" class="csl-entry">
Binder, David A. 1983a. <span>“On the Variances of Asymptotically Normal Estimators from Complex Surveys.”</span> <em>International Statistical Review</em> 51: 279–92.
</div>
<div id="ref-fuller1975regression" class="csl-entry">
Fuller, Wayne A. 1975. <span>“Regression Analysis for Sample Survey.”</span> <em>Sankyha, Series C</em> 37: 117–32.
</div>
<div id="ref-fuller2002regression" class="csl-entry">
———. 2002. <span>“Regression Estimation for Survey Samples (with Discussion).”</span> <em>Survey Methodology</em> 28 (1): 5–23.
</div>
<div id="ref-Heeringa_West_Berglund_2017" class="csl-entry">
Heeringa, Steven G., Brady T. West, and Patricia A. Berglund. 2017a. <em>Applied Survey Data Analysis</em>. Chapman and Hall CRC Statistics in the Social and Behavioral Sciences Series. CRC Press.
</div>
<div id="ref-kish1974inference" class="csl-entry">
Kish, Leslie, and Martin R Frankel. 1974. <span>“Inference from Complex Samples.”</span> <em>Journal of the Royal Statistical Society, Series B</em> 36: 1–37.
</div>
<div id="ref-neter1996applied" class="csl-entry">
Neter, John, William Wasserman, and Michael H. Kutner. 1996. <em>Applied Linear Statistical Models</em>. McGraw-Hill.
</div>
<div id="ref-pfeffermann2011modelling" class="csl-entry">
Pfeffermann, Danny. 2011. <span>“Modelling of Complex Survey Data: Why Model? Why Is It a Problem? How Can We Approach It?”</span> <em>Survey Methodology</em> 37 (2): 115–36.
</div>
<div id="ref-shah1977inference" class="csl-entry">
Shah, B. V., M. M. Holt, and R. F. Folsom. 1977. <span>“Inference about Regression Models from Sample Survey Data.”</span> <em>Bulletin of the International Statistical Institute</em> 41 (3): 43–57.
</div>
<div id="ref-skinner1989analysis" class="csl-entry">
Skinner, Chris J, Daniell Holt, and Tom M F Smith. 1989. <em>Analysis of Complex Surveys</em>. New York: John Wiley &amp; Sons.
</div>
<div id="ref-Wolter_2007" class="csl-entry">
Wolter, Kirk M. 2007. <em>Introduction to Variance Estimation</em>. 2nd ed. Statistics for Social and Behavioral Sciences. Springer.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="some-inferential-approaches-to-modelling-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="logistic-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psirusteam/Chapter9HHS/04Regression.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Chapter 9.pdf", "Chapter 9.epub", "Chapter 9.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"tconfig": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
