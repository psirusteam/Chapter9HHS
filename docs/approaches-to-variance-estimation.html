<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.2 Approaches to Variance Estimation | CHAPTER 9: ANALYSIS OF HOUSEHOLD SURVEY DATA</title>
  <meta name="description" content="Chapter 9 of UN Household Survey Handbook" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="2.2 Approaches to Variance Estimation | CHAPTER 9: ANALYSIS OF HOUSEHOLD SURVEY DATA" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapter 9 of UN Household Survey Handbook" />
  <meta name="github-repo" content="psirusteam/Chapter9HHS" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.2 Approaches to Variance Estimation | CHAPTER 9: ANALYSIS OF HOUSEHOLD SURVEY DATA" />
  
  <meta name="twitter:description" content="Chapter 9 of UN Household Survey Handbook" />
  

<meta name="author" content="Andrés Gutiérrez, Pedro Luis do Nascimento Silva" />


<meta name="date" content="2024-12-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="parameters-and-estimators.html"/>
<link rel="next" href="using-software-to-generate-valid-inferences.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Chapter 9 of UN Household Survey Handbook.</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="planning-analysis.html"><a href="planning-analysis.html"><i class="fa fa-check"></i><b>1</b> Planning Analysis</a>
<ul>
<li class="chapter" data-level="1.1" data-path="primary-data-producers.html"><a href="primary-data-producers.html"><i class="fa fa-check"></i><b>1.1</b> Primary data producers</a></li>
<li class="chapter" data-level="1.2" data-path="secondary-data-users.html"><a href="secondary-data-users.html"><i class="fa fa-check"></i><b>1.2</b> Secondary Data Users</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="secondary-data-users.html"><a href="secondary-data-users.html#quality-control-for-secondary-analysts"><i class="fa fa-check"></i><b>1.2.1</b> Quality Control for Secondary Analysts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="accounting-for-the-sampling-design.html"><a href="accounting-for-the-sampling-design.html"><i class="fa fa-check"></i><b>2</b> Accounting for the sampling design</a>
<ul>
<li class="chapter" data-level="2.1" data-path="parameters-and-estimators.html"><a href="parameters-and-estimators.html"><i class="fa fa-check"></i><b>2.1</b> Parameters and estimators</a></li>
<li class="chapter" data-level="2.2" data-path="approaches-to-variance-estimation.html"><a href="approaches-to-variance-estimation.html"><i class="fa fa-check"></i><b>2.2</b> Approaches to Variance Estimation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="approaches-to-variance-estimation.html"><a href="approaches-to-variance-estimation.html#estimating-equations"><i class="fa fa-check"></i><b>2.2.1</b> Estimating equations</a></li>
<li class="chapter" data-level="2.2.2" data-path="approaches-to-variance-estimation.html"><a href="approaches-to-variance-estimation.html#ultimate-cluster-method"><i class="fa fa-check"></i><b>2.2.2</b> Ultimate Cluster Method</a></li>
<li class="chapter" data-level="2.2.3" data-path="approaches-to-variance-estimation.html"><a href="approaches-to-variance-estimation.html#bootstrap-method"><i class="fa fa-check"></i><b>2.2.3</b> Bootstrap Method</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="using-software-to-generate-valid-inferences.html"><a href="using-software-to-generate-valid-inferences.html"><i class="fa fa-check"></i><b>2.3</b> Using software to generate valid inferences</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="descriptive-parameters.html"><a href="descriptive-parameters.html"><i class="fa fa-check"></i><b>3</b> Descriptive parameters</a>
<ul>
<li class="chapter" data-level="3.1" data-path="frequencies-and-proportions.html"><a href="frequencies-and-proportions.html"><i class="fa fa-check"></i><b>3.1</b> Frequencies and proportions</a></li>
<li class="chapter" data-level="3.2" data-path="totals-means-and-ratios.html"><a href="totals-means-and-ratios.html"><i class="fa fa-check"></i><b>3.2</b> Totals, means and ratios</a></li>
<li class="chapter" data-level="3.3" data-path="correlations.html"><a href="correlations.html"><i class="fa fa-check"></i><b>3.3</b> Correlations</a></li>
<li class="chapter" data-level="3.4" data-path="percentiles-and-inequality-measures.html"><a href="percentiles-and-inequality-measures.html"><i class="fa fa-check"></i><b>3.4</b> Percentiles and inequality measures</a></li>
<li class="chapter" data-level="3.5" data-path="nso-practical-example.html"><a href="nso-practical-example.html"><i class="fa fa-check"></i><b>3.5</b> NSO – Practical example</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="associations-between-variables.html"><a href="associations-between-variables.html"><i class="fa fa-check"></i><b>4</b> Associations between variables</a>
<ul>
<li class="chapter" data-level="4.1" data-path="motivation-and-concepts.html"><a href="motivation-and-concepts.html"><i class="fa fa-check"></i><b>4.1</b> Motivation and concepts</a></li>
<li class="chapter" data-level="4.2" data-path="cross-tabulations.html"><a href="cross-tabulations.html"><i class="fa fa-check"></i><b>4.2</b> Cross-tabulations</a></li>
<li class="chapter" data-level="4.3" data-path="testing-for-independence.html"><a href="testing-for-independence.html"><i class="fa fa-check"></i><b>4.3</b> Testing for independence</a></li>
<li class="chapter" data-level="4.4" data-path="tests-for-group-comparisons.html"><a href="tests-for-group-comparisons.html"><i class="fa fa-check"></i><b>4.4</b> Tests for group comparisons</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="tests-for-group-comparisons.html"><a href="tests-for-group-comparisons.html#hypothesis-test-for-the-difference-of-means"><i class="fa fa-check"></i><b>4.4.1</b> Hypothesis Test for the Difference of Means</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="nso-practical-example-1.html"><a href="nso-practical-example-1.html"><i class="fa fa-check"></i><b>4.5</b> NSO – Practical example</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="regression-modelling-survey-data.html"><a href="regression-modelling-survey-data.html"><i class="fa fa-check"></i><b>5</b> Regression: modelling survey data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="to-weight-or-not-to-weight.html"><a href="to-weight-or-not-to-weight.html"><i class="fa fa-check"></i><b>5.1</b> To weight or not to weight?</a></li>
<li class="chapter" data-level="5.2" data-path="some-inferential-approaches-to-modelling-data.html"><a href="some-inferential-approaches-to-modelling-data.html"><i class="fa fa-check"></i><b>5.2</b> Some inferential approaches to modelling data</a></li>
<li class="chapter" data-level="5.3" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>5.3</b> Linear models</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="linear-models.html"><a href="linear-models.html#basic-definitions"><i class="fa fa-check"></i><b>5.3.1</b> Basic Definitions</a></li>
<li class="chapter" data-level="5.3.2" data-path="linear-models.html"><a href="linear-models.html#estimation-of-parameters"><i class="fa fa-check"></i><b>5.3.2</b> Estimation of Parameters</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="working-with-weights.html"><a href="working-with-weights.html"><i class="fa fa-check"></i><b>5.4</b> Working with weights</a></li>
<li class="chapter" data-level="5.5" data-path="model-diagnostics.html"><a href="model-diagnostics.html"><i class="fa fa-check"></i><b>5.5</b> Model Diagnostics</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="model-diagnostics.html"><a href="model-diagnostics.html#coefficient-of-determination"><i class="fa fa-check"></i><b>5.5.1</b> Coefficient of determination</a></li>
<li class="chapter" data-level="5.5.2" data-path="model-diagnostics.html"><a href="model-diagnostics.html#standardized-residuals"><i class="fa fa-check"></i><b>5.5.2</b> Standardized Residuals</a></li>
<li class="chapter" data-level="5.5.3" data-path="model-diagnostics.html"><a href="model-diagnostics.html#influential-observations"><i class="fa fa-check"></i><b>5.5.3</b> Influential Observations</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="inference-on-model-parameters.html"><a href="inference-on-model-parameters.html"><i class="fa fa-check"></i><b>5.6</b> Inference on Model Parameters</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="inference-on-model-parameters.html"><a href="inference-on-model-parameters.html#estimation-and-prediction"><i class="fa fa-check"></i><b>5.6.1</b> Estimation and Prediction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tables.html"><a href="tables.html"><i class="fa fa-check"></i><b>6</b> Tables</a>
<ul>
<li class="chapter" data-level="6.1" data-path="presentation-tables.html"><a href="presentation-tables.html"><i class="fa fa-check"></i><b>6.1</b> Presentation tables</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="presentation-tables.html"><a href="presentation-tables.html#example-of-presentation-table-and-corresponding-text---include-in-a-box."><i class="fa fa-check"></i><b>6.1.1</b> Example of presentation table and corresponding text - include in a box.</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="reference-tables.html"><a href="reference-tables.html"><i class="fa fa-check"></i><b>6.2</b> Reference tables</a></li>
<li class="chapter" data-level="6.3" data-path="low-quality-estimates.html"><a href="low-quality-estimates.html"><i class="fa fa-check"></i><b>6.3</b> Low-Quality Estimates</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>7</b> Data visualization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="bar-charts.html"><a href="bar-charts.html"><i class="fa fa-check"></i><b>7.1</b> Bar charts</a></li>
<li class="chapter" data-level="7.2" data-path="histograms.html"><a href="histograms.html"><i class="fa fa-check"></i><b>7.2</b> Histograms</a></li>
<li class="chapter" data-level="7.3" data-path="scatter-plots.html"><a href="scatter-plots.html"><i class="fa fa-check"></i><b>7.3</b> Scatter Plots</a></li>
<li class="chapter" data-level="7.4" data-path="nso-practical-example-2.html"><a href="nso-practical-example-2.html"><i class="fa fa-check"></i><b>7.4</b> NSO – Practical example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a Chapter 9 of UN Household Survey Handbook. </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CHAPTER 9: ANALYSIS OF HOUSEHOLD SURVEY DATA</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="approaches-to-variance-estimation" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Approaches to Variance Estimation<a href="approaches-to-variance-estimation.html#approaches-to-variance-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When working with household surveys, the sample is usually only a small subset of the entire population. Because of this, it is important to provide not only the main estimates of interest, such as totals or averages, but also the level of uncertainty in these estimates. This uncertainty is often expressed as measures of variance or confidence intervals, which help us understand how much the estimates might differ if the survey was repeated.</p>
<p>Understanding and estimating uncertainty is a critical part of analyzing household survey data; by using proper methods, analysts can measure the reliability of their estimates. There are several methods to estimate the uncertainty in survey results:
* One common approach is based on approximate formulas like <em>Taylor linearization</em>, which simplifies complex relationships between variables into linear ones;</p>
<ul>
<li><p>The <em>ultimate cluster</em> method, is used in surveys that collect data through multi-stage sampling, where groups of people (clusters) are selected at different stages, exactly as household survey data is collected;</p></li>
<li><p>Estimating equations <span class="citation">(<a href="#ref-Binder1983">David A. Binder 1983b</a>)</span>, which comprises a unifying idea of sampling theory, provides a flexible framework for estimating totals, means, ratios, and other parameters as well as their corresponding variances.</p></li>
</ul>
<div id="estimating-equations" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Estimating equations<a href="approaches-to-variance-estimation.html#estimating-equations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With the help of modern software, these methods can be implemented efficiently, ensuring accurate and meaningful analysis of survey data. Many population parameters can be written/obtained as solutions for <em>population estimating equations</em>. Variance estimation for these sample-based methods follows a consistent framework. Although the details can be technical, the key idea is that the same principles used to estimate totals can be applied to estimate variances. This generality makes the method simple and versatile, allowing it to be implemented in widely used software like the <code>R survey</code> package and the <code>Stata svy</code> functions. These tools automate much of the process, making it accessible for analysts to estimate both population parameters and their associated uncertainties.</p>
<p>A generic population <em>estimating equation</em> is given by $_{i U} z_i () = 0 $, where <span class="math inline">\(z_i(\bullet)\)</span> is an <em>estimating function</em> evaluated for unit <span class="math inline">\(i\)</span> and <span class="math inline">\(\theta\)</span> is a population parameter of interest. These equations provide a general way to define and calculate many population parameters, such as totals, means, and ratios. The concept is straightforward: population parameters can be defined as solutions to specific equations that involve all the units in the population. This approach is flexible and can be adapted to calculate many different types of parameters.</p>
<ul>
<li><p>For the case of the population total, take <span class="math inline">\(z_i(\theta) = y_i - \theta / N\)</span>. The corresponding population estimation equation is given by <span class="math inline">\(\sum _{i \in U} (y_i - \theta / N) = 0\)</span>, and solving for <span class="math inline">\(\theta\)</span> gives the population total <span class="math inline">\(\theta_U = \sum _{i \in U} y_i \ = \ Y\)</span>.</p></li>
<li><p>For ratios of population totals, taking <span class="math inline">\(z_i(\theta) = y_i - \theta x_i\)</span>, the corresponding population estimating equation is given by <span class="math inline">\(\sum _{i \in U} (y_i - \theta x_i) = 0\)</span>. Solving for <span class="math inline">\(\theta\)</span> gives the <em>population ratio</em> <span class="math inline">\(\theta_U = \sum _{i \in U} y_i / \sum _{i \in U} x_i \ = \ R\)</span>.</p></li>
<li><p>Similarly, for population means, take <span class="math inline">\(z_i(\theta) = y_i - \theta\)</span>.</p></li>
</ul>
<p>The idea of defining population parameters as solutions to population estimating equations allows defining a general method for obtaining corresponding sample estimators. It is a matter of using the <em>sample estimating equations</em> <span class="math inline">\(\sum _{k \in s} d_k \, z_k (\theta) = 0\)</span>. Under <em>probability sampling</em>, full response and with <span class="math inline">\(d_k = 1 / \pi_k\)</span>, the sample sum in the left hand side is unbiased towards the population sum in the corresponding population estimating equation. Solving the sample estimating equation yields consistent estimators for the corresponding population parameters.</p>
<p>A consistent estimator for the variance of estimators obtained as solutions of sample estimating equations can be obtained as:</p>
<p><span class="math display">\[
\widehat V_p (\widehat \theta) = \left[ \widehat J ( \widehat \theta) \right] ^{-1} \widehat V_p \left[ \sum _{k \in s} d_k \, z_k (\widehat \theta)\right] \left[ \widehat J ( \widehat \theta) \right] ^{-1}
\]</span></p>
<p>Where <span class="math inline">\(\widehat J (\widehat \theta) = \sum _{k \in s} d_k \, \left[ \partial{z_k ( \theta)} / \partial \theta \right]_{\theta = \widehat \theta}\)</span>.</p>
<p>This approach implies that one is able to estimate many population parameters and corresponding variances using essentially well known methods for estimating totals. Its simplicity and generality have enabled the development of software such as the <code>R survey</code> package, the <code>Stata svy</code> functions and others.</p>
</div>
<div id="ultimate-cluster-method" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Ultimate Cluster Method<a href="approaches-to-variance-estimation.html#ultimate-cluster-method" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <em>Ultimate Cluster</em> method is a straightforward and powerful approach for estimating the uncertainty (variance) of totals in surveys that use multi-stage cluster sampling designs. This method, proposed by <span class="citation">Hansen, Hurwitz, and Madow (<a href="#ref-Hansen1953">1953</a>)</span>, simplifies the complex nature of multi-stage designs by focusing only on the variation between the largest groups, known as Primary Sampling Units (PSUs). It assumes that the PSUs were selected randomly and independently, even if they were not actually chosen this way in the sampling process. This assumption allows for a simpler analysis while still providing reliable variance estimates.</p>
<p>The method considers only the variation between information available at the level of PSUs, and assumes that these would have been selected with replacement from the PSU population. This idea is simple, but quite powerful, because it allows to accommodate a variety of sampling designs, involving stratification and selection with unequal probabilities (with or without replacement) of both PSUs as well as lower level sampling units (households and individuals). The requirements for the application of this method are:</p>
<ul>
<li><p>One has unbiased estimators of totals for the variable of interest for each sampled PSU;</p></li>
<li><p>Data are available for at least two sampled PSUs in each stratum (if the sample is stratified in the first stage);</p></li>
<li><p>The survey dataset contains all the information regarding PSUs, strata and weights.</p></li>
</ul>
<p>Consider a multi-stage sampling design, in which <span class="math inline">\(m_{h}\)</span> PSUs are selected in stratum <span class="math inline">\(h,\)</span> <span class="math inline">\(h=1,\ldots ,H\)</span>. Let <span class="math inline">\(\pi_{hi}\)</span> be the inclusion probability of PSU <span class="math inline">\(i\)</span> in stratum <span class="math inline">\(h\)</span>, and by <span class="math inline">\(\widehat{Y}_{hi}\)</span> an unbiased estimator of the total <span class="math inline">\(Y_{hi}\)</span> of the survey variable <span class="math inline">\(y\)</span> for the <span class="math inline">\(i\)</span>-th PSU in stratum <span class="math inline">\(h\)</span>. Hence an unbiased estimator of the population total <span class="math inline">\(Y = \sum_{h=1}^{H} \sum_{i \in U_{1h}} Y_{hi}\)</span> is given by <span class="math inline">\(\widehat{Y}_{UC} = \sum_{h=1}^{H} \sum_{i \in s_{1h}} d_{hi} \widehat{Y}_{hi}\)</span>, and the <em>ultimate cluster</em> estimator of the corresponding variance is given by:</p>
<p><span class="math display">\[
\widehat{V}_{UC} \left( \widehat{Y}_{UC}\right) = \sum_{h=1}^{H} \frac{m_{h}}
{m_{h}-1} \sum_{i \in s_{1h}} \left( d_{hi} \widehat{Y}_{hi} - \frac{\widehat{Y}_{h}}{m_{h}} \right) ^{2}
\]</span></p>
<p>where <span class="math inline">\(U_{1h}\)</span> and <span class="math inline">\(s_{1h}\)</span> are the population and sample sets of PSUs in stratum <span class="math inline">\(h\)</span>, <span class="math inline">\(d_{hi} = 1 / \pi_{hi}\)</span>, <span class="math inline">\(\widehat{Y}_{h} = \sum_{i \in s_{1h}} d_{hi} \widehat{Y}_{hi}\)</span> for <span class="math inline">\(h=1,\ldots ,H\)</span>. (See for example, <span class="citation">(<a href="#ref-Shah1993">Babubhai. V. Shah et al. 1993</a>)</span>, p. 4).</p>
<p>Although the method was originally proposed for estimation of variances of estimated totals, it can also be applied in combination with estimating equations approach to obtain variance estimates for estimators of other population quantities that can be obtained as solutions to sample estimating equations. This makes the method versatile and useful for a wide range of applications in survey analysis.</p>
<p>One key assumption of the method is that, within strata, the PSUs were selected independently and with replacement. In reality, most surveys select PSUs without replacement, which is a more efficient design. However, the variance estimates produced by the <em>Ultimate Cluster</em> method are generally close enough to be useful, even under these conditions. This practical simplicity is why the method is widely used in survey analysis.</p>
<p>The <em>Ultimate Cluster</em> method is particularly attractive because of its simplicity. Survey practitioners often prefer it over more complex approaches that account for all stages of the sampling design. Although these detailed methods may provide slightly more accurate variance estimates, they are significantly harder to implement and require more detailed information about the sampling process. In contrast, this method offers a reasonable approximation that works well for most practical purposes, especially for estimating totals or averages. A discussion about Quality of this approximation and alternatives can be found in <span class="citation">(<a href="#ref-SSW92">Särndal, Swensson, and Wretman 1992</a>)</span>, p. 153.</p>
</div>
<div id="bootstrap-method" class="section level3 hasAnchor" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Bootstrap Method<a href="approaches-to-variance-estimation.html#bootstrap-method" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When the user does not have access to information of PSUs or strata in the database, the <em>Ultimate Cluster</em> method cannot be used, and some other methods should be considered. Among them, we have replication-based methods; in particular, the <em>bootstrap</em> method, which comprises a powerful and flexible approach for estimating variances in surveys, particularly when dealing with complex survey designs that involve multiple stages or stratification. Originally proposed by <span class="citation">Efron (<a href="#ref-Efron1979">1979</a>)</span>, the version commonly used for household surveys is called the Rao-Wu-Yue Rescaling Bootstrap <span class="citation">(<a href="#ref-Rao1992">Rao, Wu, and Yue 1992</a>)</span>. This method is well-suited for stratified multi-stage sampling designs and has become a widely used tool for variance estimation with complex survey data.</p>
<p>The <em>bootstrap</em> method relies on creating many new “replicated” datasets, which are slightly different versions of the original sample. These replicated datasets mimic the process of repeatedly drawing samples from the population. By analyzing the variation in results across these datasets, we can estimate how much uncertainty there is in our estimates from the original sample.</p>
<ol style="list-style-type: decimal">
<li><p>First, we create a new sample for each stratum by randomly selecting primary sampling units (PSUs) from the original sample, allowing PSUs to be selected more than once (with replacement). Each selected PSU is included in the new dataset along with all its associated data. The size of this random sample with replacement is of <span class="math inline">\(m_h - 1\)</span> PSUs in each of the <span class="math inline">\(H\)</span> design strata.</p></li>
<li><p>This process of creating new samples is repeated many times, usually hundreds or thousands, to produce multiple “replicated” datasets. That is, repeat Step 1 <span class="math inline">\(R\)</span> times, and denote by <span class="math inline">\(m_{hi}(r)\)</span> the number of times that the PSU <span class="math inline">\(i\)</span> of stratum <span class="math inline">\(h\)</span> was selected for the sample in replicate <span class="math inline">\(r\)</span>.</p></li>
<li><p>For each replicate, <em>bootstrap</em> weights are calculated for each unit. These weights account for how often each PSU appears in the replicate and ensure that the replicated datasets remain representative of the population. The <em>bootstrap</em> weight of unit <span class="math inline">\(k\)</span> within PSU <span class="math inline">\(i\)</span> of stratum <span class="math inline">\(h\)</span> is <span class="math inline">\(w_{hik}(r) = w_{hik} \times \frac {m_h}{m_h - 1} \times m_{hi}(r)\)</span>.</p></li>
<li><p>The parameter of interest, such as a total or mean, is estimated for each replicated dataset using the <em>bootstrap</em> weights. That is, for each replica <span class="math inline">\(r\)</span>, calculate an estimate <span class="math inline">\(\widehat \theta_{(r)}\)</span> of the target parameter <span class="math inline">\(theta\)</span> using the <em>bootstrap</em> weights <span class="math inline">\(w_{hik} (r)\)</span> instead of the original weights <span class="math inline">\(w_{hik\)</span>.</p></li>
<li><p>Finally, the variability of the results across all replicated datasets is used to estimate the variance. The idea is that the variation in these replicate estimates reflects the uncertainty in the original estimate. This estimate of the variance takes the following form:</p></li>
</ol>
<p><span class="math display">\[
\widehat V_{B} \left( \widehat \theta \right) = \frac {1} {R} \sum_{r=1}^R \left( \widehat \theta_{(r)} - \tilde \theta \right)^2
\]</span></p>
<p>where <span class="math inline">\(\tilde \theta = \frac 1 R \sum_{r=1}^R \widehat \theta_{(r)}\)</span> is the average of the replica estimates.</p>
<p>Whenever the original sampling weights <span class="math inline">\(w_{hik}\)</span> receive non-response adjustments or are calibrated, the corresponding non-response adjustments and/or calibration of the basic weights must be repeated for each replica, so that the variance estimates adequately reflect the effects of the calibration and non-response adjustments on the uncertainty of the point estimates. This ensures that the variance estimates accurately reflect the additional uncertainty introduced by these adjustments.</p>
<p>The bootstrap method has several advantages. It works well for complex survey designs and can handle a wide range of parameters, including those that are difficult to estimate using traditional methods, such as medians or other nonlinear statistics. It also provides a way to estimate variances when other methods are not available or practical to use. The method is particularly helpful for survey analysts who may not have access to specialized software for calculating variances.</p>
<p>Many modern statistical software tools, including the <code>survey</code> package in R, support bootstrap replication and variance estimation, making it accessible to a wide range of users. While the bootstrap method is computationally intensive, requiring many replicated datasets to be created and analyzed, it is highly effective. It provides robust variance estimates even for complex parameters and remains one of the most flexible tools for analyzing survey data.</p>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Binder1983" class="csl-entry">
Binder, David A. 1983b. <span>“On the Variances of Asymptotically Normal Estimators from Complex Surveys.”</span> <em>International Statistical Review</em> 51 (3): 279–92. <a href="https://doi.org/10.2307/1402588">https://doi.org/10.2307/1402588</a>.
</div>
<div id="ref-Efron1979" class="csl-entry">
Efron, Bradley. 1979. <span>“Bootstrap Methods: Another Look at the Jackknife.”</span> <em>The Annals of Statistics</em> 7 (1): 1–26.
</div>
<div id="ref-Hansen1953" class="csl-entry">
Hansen, Morris H., William N. Hurwitz, and William G. Madow. 1953. <em>Sample Survey Methods and Theory</em>. Vol. 1 and 2. New York: John Wiley; Sons.
</div>
<div id="ref-Rao1992" class="csl-entry">
Rao, J. N. K., C F J Wu, and K. Yue. 1992. <span>“Some Recent Work on Resampling Methods for Complex Surveys.”</span> <em>Survey Methodology</em> 18: 209–17.
</div>
<div id="ref-SSW92" class="csl-entry">
Särndal, Carl-Erik, Bengt Swensson, and Jan Wretman. 1992. <em>Model Assisted Survey Sampling</em>. New York: Springer-Verlag.
</div>
<div id="ref-Shah1993" class="csl-entry">
Shah, Babubhai. V, Ralph E Folsom, Lisa LaVange, Sara C Wheeless, Kerrie E Boyle, and Rick L Williams. 1993. <span>“Statistical Methods and Mathematical Algorithms Used in SUDAAN.”</span> Research Triangle Institute.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="parameters-and-estimators.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="using-software-to-generate-valid-inferences.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psirusteam/Chapter9HHS/02SamplingStrategy.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Chapter 9.pdf", "Chapter 9.epub", "Chapter 9.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"tconfig": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
