<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="4.3 Linear models | CHAPTER 9: ANALYSIS OF HOUSEHOLD SURVEY DATA" />
<meta property="og:type" content="book" />

<meta property="og:description" content="Chapter 9 of UN Household Survey Handbook" />
<meta name="github-repo" content="psirusteam/Chapter9HHS" />

<meta name="author" content="Andrés Gutiérrez, Pedro Luis do Nascimento Silva" />

<meta name="date" content="2024-09-24" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="Chapter 9 of UN Household Survey Handbook">

<title>4.3 Linear models | CHAPTER 9: ANALYSIS OF HOUSEHOLD SURVEY DATA</title>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>




<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if bootstrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#abstract" id="toc-abstract">Abstract</a></li>
<li><a href="introduction.html#introduction" id="toc-introduction">Introduction</a></li>
<li class="has-sub"><a href="1-the-golden-pair-sample-design-and-estimator.html#the-golden-pair-sample-design-and-estimator" id="toc-the-golden-pair-sample-design-and-estimator"><span class="toc-section-number">1</span> The golden pair: sample design and estimator</a>
<ul>
<li><a href="1.1-parameters-and-estimators.html#parameters-and-estimators" id="toc-parameters-and-estimators"><span class="toc-section-number">1.1</span> Parameters and estimators</a></li>
<li><a href="1.2-uncertainty-in-household-surveys.html#uncertainty-in-household-surveys" id="toc-uncertainty-in-household-surveys"><span class="toc-section-number">1.2</span> Uncertainty in household surveys</a></li>
<li><a href="1.3-ultimate-cluster-method.html#ultimate-cluster-method" id="toc-ultimate-cluster-method"><span class="toc-section-number">1.3</span> Ultimate Cluster Method</a></li>
<li><a href="1.4-using-software-to-generate-valid-inferences.html#using-software-to-generate-valid-inferences" id="toc-using-software-to-generate-valid-inferences"><span class="toc-section-number">1.4</span> Using software to generate valid inferences</a></li>
</ul></li>
<li class="has-sub"><a href="2-descriptive-parameters.html#descriptive-parameters" id="toc-descriptive-parameters"><span class="toc-section-number">2</span> Descriptive parameters</a>
<ul>
<li class="has-sub"><a href="2.1-frequencies.html#frequencies" id="toc-frequencies"><span class="toc-section-number">2.1</span> Frequencies</a>
<ul>
<li><a href="2.1-frequencies.html#point-estimation" id="toc-point-estimation"><span class="toc-section-number">2.1.1</span> Point Estimation</a></li>
</ul></li>
<li class="has-sub"><a href="2.2-means-proportions-and-ratios.html#means-proportions-and-ratios" id="toc-means-proportions-and-ratios"><span class="toc-section-number">2.2</span> Means, proportions, and ratios</a>
<ul>
<li><a href="2.2-means-proportions-and-ratios.html#total-estimates" id="toc-total-estimates"><span class="toc-section-number">2.2.1</span> Total Estimates</a></li>
<li><a href="2.2-means-proportions-and-ratios.html#estimation-of-averages" id="toc-estimation-of-averages"><span class="toc-section-number">2.2.2</span> Estimation of Averages</a></li>
<li><a href="2.2-means-proportions-and-ratios.html#proportion-estimation" id="toc-proportion-estimation"><span class="toc-section-number">2.2.3</span> Proportion Estimation</a></li>
<li><a href="2.2-means-proportions-and-ratios.html#relationship-between-variables" id="toc-relationship-between-variables"><span class="toc-section-number">2.2.4</span> Relationship Between Variables</a></li>
</ul></li>
<li class="has-sub"><a href="2.3-percentiles-and-inequality-measures.html#percentiles-and-inequality-measures" id="toc-percentiles-and-inequality-measures"><span class="toc-section-number">2.3</span> Percentiles and inequality measures</a>
<ul>
<li><a href="2.3-percentiles-and-inequality-measures.html#estimation-of-the-gini-coefficient" id="toc-estimation-of-the-gini-coefficient"><span class="toc-section-number">2.3.1</span> Estimation of the Gini Coefficient</a></li>
</ul></li>
<li><a href="2.4-nso-practical-example.html#nso-practical-example" id="toc-nso-practical-example"><span class="toc-section-number">2.4</span> NSO – Practical example</a></li>
</ul></li>
<li class="has-sub"><a href="3-comparisons-and-association.html#comparisons-and-association" id="toc-comparisons-and-association"><span class="toc-section-number">3</span> Comparisons and association</a>
<ul>
<li class="has-sub"><a href="3.1-cross-tabulations.html#cross-tabulations" id="toc-cross-tabulations"><span class="toc-section-number">3.1</span> Cross-tabulations</a>
<ul>
<li><a href="3.1-cross-tabulations.html#contingency-tables" id="toc-contingency-tables"><span class="toc-section-number">3.1.1</span> Contingency Tables</a></li>
</ul></li>
<li class="has-sub"><a href="3.2-tests-for-group-comparisons.html#tests-for-group-comparisons" id="toc-tests-for-group-comparisons"><span class="toc-section-number">3.2</span> Tests for group comparisons</a>
<ul>
<li><a href="3.2-tests-for-group-comparisons.html#hypothesis-test-for-the-difference-of-means" id="toc-hypothesis-test-for-the-difference-of-means"><span class="toc-section-number">3.2.1</span> Hypothesis Test for the Difference of Means</a></li>
<li><a href="3.2-tests-for-group-comparisons.html#contrasts" id="toc-contrasts"><span class="toc-section-number">3.2.2</span> Contrasts</a></li>
</ul></li>
<li><a href="3.3-tests-of-independence.html#tests-of-independence" id="toc-tests-of-independence"><span class="toc-section-number">3.3</span> Tests of Independence</a></li>
<li><a href="3.4-correlation.html#correlation" id="toc-correlation"><span class="toc-section-number">3.4</span> Correlation</a></li>
<li><a href="3.5-nso-practical-example-1.html#nso-practical-example-1" id="toc-nso-practical-example-1"><span class="toc-section-number">3.5</span> NSO – Practical example</a></li>
</ul></li>
<li class="has-sub"><a href="4-regression-modelling-survey-data.html#regression-modelling-survey-data" id="toc-regression-modelling-survey-data"><span class="toc-section-number">4</span> Regression: modelling survey data</a>
<ul>
<li><a href="4.1-to-weight-or-not-to-weight.html#to-weight-or-not-to-weight" id="toc-to-weight-or-not-to-weight"><span class="toc-section-number">4.1</span> To weight or not to weight?</a></li>
<li><a href="4.2-some-inferential-approaches-to-modelling-data.html#some-inferential-approaches-to-modelling-data" id="toc-some-inferential-approaches-to-modelling-data"><span class="toc-section-number">4.2</span> Some inferential approaches to modelling data</a></li>
<li class="has-sub"><a href="4.3-linear-models.html#linear-models" id="toc-linear-models"><span class="toc-section-number">4.3</span> Linear models</a>
<ul>
<li><a href="4.3-linear-models.html#basic-definitions" id="toc-basic-definitions"><span class="toc-section-number">4.3.1</span> Basic Definitions</a></li>
<li><a href="4.3-linear-models.html#estimation-of-parameters-in-a-regression-model-with-complex-samples" id="toc-estimation-of-parameters-in-a-regression-model-with-complex-samples"><span class="toc-section-number">4.3.2</span> Estimation of Parameters in a Regression Model with Complex Samples</a></li>
</ul></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="linear-models" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Linear models</h2>
<div id="basic-definitions" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Basic Definitions</h3>
<p>As noted by <span class="citation">Heeringa, West, and Berglund (<a href="#ref-Heeringa_West_Berglund_2017">2017</a>)</span>, the first authors to empirically discuss the impact of complex sampling designs on regression model inferences were <span class="citation">Kish and Frankel (<a href="#ref-kish1974inference">1974</a>)</span>. Later, <span class="citation">Fuller (<a href="#ref-fuller1975regression">1975</a>)</span> developed a variance estimator for regression model parameters based on Taylor linearization with unequal weighting of observations under stratified and two-stage sampling designs.</p>
<p>As is well known, the use of regression model theory requires certain statistical assumptions to be met, which can sometimes be challenging to verify in practice. In this regard, <span class="citation">Shah, Holt, and Folsom (<a href="#ref-shah1977inference">1977</a>)</span> discuss some aspects related to the violation of these assumptions and provide appropriate methods for making inferences about the estimated parameters of linear regression models using survey data.</p>
<p>Similarly, <span class="citation">David A. Binder (<a href="#ref-binder1983variances">1983a</a>)</span> obtained the sampling distributions of estimators for regression parameters in finite populations and related variance estimators in the context of complex samples. <span class="citation">Skinner, Holt, and Smith (<a href="#ref-skinner1989analysis">1989</a>)</span> studied the properties of variance estimators for regression coefficients under complex sample designs. Later, <span class="citation">Fuller (<a href="#ref-fuller2002regression">2002</a>)</span> provided a summary of estimation methods for regression models containing information related to complex samples. Finally, <span class="citation">Pfeffermann (<a href="#ref-pfeffermann2011modelling">2011</a>)</span> discussed various approaches to fitting linear regression models to complex survey data, presenting empirical support for the use of the “<em>q-weighted</em>” method, which is recommended in this document.</p>
<p>A simple linear regression model is defined as <span class="math inline">\(y=\beta_{0}+\beta_{1}x+\varepsilon\)</span>, where <span class="math inline">\(y\)</span> represents the dependent variable, <span class="math inline">\(x\)</span> is the independent variable, and <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{1}\)</span> are the model parameters. The variable <span class="math inline">\(\varepsilon\)</span> is known as the random error of the model and is defined as <span class="math inline">\(\varepsilon=y-\hat{y}=y-\beta_{0}+\beta_{1}x\)</span>.</p>
<p>Generalizing the previous model, multiple linear regression models are defined by allowing the dependent variable to interact with more than two variables, as presented below:</p>
<p><span class="math display">\[
y  =  \boldsymbol{x}\boldsymbol{\beta}+\varepsilon
  =  \sum_{j=0}^{p}\beta_{j}x_{j}+\varepsilon
=  \beta_{0}+\beta_{1}x_{1}+\cdots+\beta_{p}x_{p}+\varepsilon
\]</span></p>
<p>Another way to write the multiple regression model is:</p>
<p><span class="math display">\[
y_{i}  =  x_{i}\boldsymbol{\beta}+\varepsilon_{i}
\]</span></p>
<p>Where, <span class="math inline">\(x_{i}=\left[1\,x_{1i}\,\ldots\,x_{pi}\right]\)</span> and <span class="math inline">\(\boldsymbol{\beta}^{T}=\left[\beta_{0}\,\,\beta_{1}\,\,\ldots\,\,\beta_{p}\right]\)</span>.</p>
<p>The subscript <span class="math inline">\(i\)</span> refers to the sample element or respondent in the dataset. <span class="citation">Heeringa, West, and Berglund (<a href="#ref-Heeringa_West_Berglund_2017">2017</a>)</span> present some considerations for regression models, which are described below:</p>
<ul>
<li><span class="math inline">\(E\left(\varepsilon_{i}\mid x_{i}\right)=0\)</span>, meaning that the expected value of the residuals conditioned on the covariates is zero.</li>
<li><span class="math inline">\(Var\left(\varepsilon_{i}\mid x_{i}\right)=\sigma_{y,x}^{2}\)</span> (homogeneity of variance), meaning that the variance of the residuals conditioned on the covariates is constant.</li>
<li><span class="math inline">\(\varepsilon_{i}\mid x_{i}\sim N\left(0,\,\sigma_{y,x}^{2}\right)\)</span> (normality of errors), meaning that the residuals conditioned on the covariates follow a normal distribution. This property also extends to the response variable <span class="math inline">\(y_{i}\)</span>.</li>
<li><span class="math inline">\(cov\left(\varepsilon_{i},\,\varepsilon_{j}\mid x_{i},x_{j}\right)\)</span> (independence of residuals), meaning that the residuals in different observed units are not correlated with the values given by their predictor variables.</li>
</ul>
<p>Once the linear regression model and its assumptions are defined, it can be deduced that the best unbiased linear estimator is defined as the expected value of the dependent variable conditioned on the independent variables <span class="math inline">\(x\)</span>, as:</p>
<p><span class="math display">\[
E\left(y\mid x\right)=\hat{\beta}_{0}+\hat{\beta_{1}}x_{1}+\hat{\beta}_{2}x_{2}+\cdots+\hat{\beta}_{p}x_{p}
\]</span></p>
<p><span class="math display">\[
\hat{y}  =  E\left(y\mid x\right)
=  E\left(\boldsymbol{x}\boldsymbol{\beta}\right)+E\left(\varepsilon\right)
=  \boldsymbol{x}\boldsymbol{\beta}+0
  =  \beta_{0}+\beta_{1}x_{1}+\cdots+\beta_{p}x_{p}
\]</span></p>
<p>Additionally,</p>
<p><span class="math display">\[
var\left(y_{i}\mid x_{i}\right)  =  \sigma_{y,x}^{2}
\]</span></p>
<p>It is also established that:</p>
<p><span class="math display">\[
cov\left(y_{i},y_{j}\mid x_{i},x_{j}\right)  = 0
\]</span></p>
<p>Thus, the response variable has the following distribution:</p>
<p><span class="math display">\[
y_{i}  \sim  N\left(x_{i}\boldsymbol{\beta},\sigma_{y,x}^{2}\right)
\]</span></p>
</div>
<div id="estimation-of-parameters-in-a-regression-model-with-complex-samples" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Estimation of Parameters in a Regression Model with Complex Samples</h3>
<p>Once the assumptions of the model and the distributional characteristics of the errors are established, the next step is the process of parameter estimation. As an illustrative and introductory example, if instead of observing a sample of size <span class="math inline">\(n\)</span> from the <span class="math inline">\(N\)</span> elements of the population, a complete census had been conducted, the finite population regression parameter <span class="math inline">\(\beta_{1}\)</span> could be calculated as follows:</p>
<p><span class="math display">\[
\beta_{1}  =  \frac{ \sum_{i=1}^{N}\left(X_{i}-\bar{X}\right)\left(Y_{i}-\bar{Y}\right)}{\sum_{i=1}^{N}\left(X_{i}-\bar{X}\right)^{2}}
\]</span></p>
<p>Now, when estimating the parameters of a linear regression model considering that the observed information comes from surveys with complex samples, the standard approach to estimating regression coefficients and their standard errors is altered. The main reason for this change is that data collected through a complex survey generally does not have an identical distribution, and the assumption of independence cannot be maintained since the sample design is constructed with dependencies (as most complex designs include stratification, clustering, unequal selection probabilities, etc.).</p>
<p>In this context, when fitting regression models with such datasets, using conventional estimators derived from traditional methods (such as maximum likelihood, for example) will induce bias because these methods assume the data are independently and identically distributed and come from a specific probability distribution (binomial, Poisson, exponential, normal, etc.). Instead, according to <span class="citation">Wolter (<a href="#ref-Wolter_2007">2007</a>)</span>, robust non-parametric methods based on Taylor linearization or variance estimation methods using replication (Jackknife, bootstrapping, etc.) are used to eliminate bias by including the sampling design in the analyses.</p>
<p>For illustrative purposes, the estimation of the parameter <span class="math inline">\(\beta_{1}\)</span> and its variance for a simple linear regression will be shown. The extension to multiple regression parameter estimation is algebraically complex and beyond the scope of this book. Below is the estimation of the slope and its variance in a simple linear regression model:</p>
<p><span class="math display">\[
\hat{\beta_{1}}  =  \frac{{\sum_{h}^{H}\sum_{\alpha}^{a_{h}}\sum_{i=1}^{n_{h\alpha}}\omega_{h\alpha i}\left(y_{h\alpha i}-\hat{\bar{y}}_{\omega}\right)\left(x_{h\alpha i}-\hat{\bar{x}}_{\omega}\right)}}{{ \sum_{h}^{H}\sum_{\alpha}^{a_{h}}\sum_{i=1}^{n_{h\alpha}}\omega_{h\alpha i}\left(x_{h\alpha i}-\hat{\bar{x}}_{\omega}\right)^{2}}}
\]</span></p>
<p><span class="math display">\[
\hat{\beta_{1}} = \frac{\sum_{h}^{H}\sum_{\alpha}^{a_{h}}\sum_{i=1}^{n_{h\alpha}}\omega_{h\alpha i}\left(y_{h\alpha i}-\hat{\bar{y}}_{\omega}\right)\left(x_{h\alpha i}-\hat{\bar{x}}_{\omega}\right)}{\sum_{h}^{H}\sum_{\alpha}^{a_{h}}\sum_{i=1}^{n_{h\alpha}}\omega_{h\alpha i}\left(x_{h\alpha i}-\hat{\bar{x}}_{\omega}\right)^{2}}
\]</span></p>
<p>As can be seen in the above equation, the parameter estimator is a ratio of totals; therefore, its variance is given by:</p>

</div>
</div>
<!-- </div> -->
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-binder1983variances" class="csl-entry">
Binder, David A. 1983a. <span>“On the Variances of Asymptotically Normal Estimators from Complex Surveys.”</span> <em>International Statistical Review</em> 51: 279–92.
</div>
<div id="ref-fuller1975regression" class="csl-entry">
Fuller, Wayne A. 1975. <span>“Regression Analysis for Sample Survey.”</span> <em>Sankyha, Series C</em> 37: 117–32.
</div>
<div id="ref-fuller2002regression" class="csl-entry">
———. 2002. <span>“Regression Estimation for Survey Samples (with Discussion).”</span> <em>Survey Methodology</em> 28 (1): 5–23.
</div>
<div id="ref-Heeringa_West_Berglund_2017" class="csl-entry">
Heeringa, Steven G., Brady T. West, and Patricia A. Berglund. 2017. <em>Applied Survey Data Analysis</em>. Chapman and Hall CRC Statistics in the Social and Behavioral Sciences Series. CRC Press.
</div>
<div id="ref-kish1974inference" class="csl-entry">
Kish, Leslie, and Martin R Frankel. 1974. <span>“Inference from Complex Samples.”</span> <em>Journal of the Royal Statistical Society, Series B</em> 36: 1–37.
</div>
<div id="ref-pfeffermann2011modelling" class="csl-entry">
Pfeffermann, Danny. 2011. <span>“Modelling of Complex Survey Data: Why Model? Why Is It a Problem? How Can We Approach It?”</span> <em>Survey Methodology</em> 37 (2): 115–36.
</div>
<div id="ref-shah1977inference" class="csl-entry">
Shah, B. V., M. M. Holt, and R. F. Folsom. 1977. <span>“Inference about Regression Models from Sample Survey Data.”</span> <em>Bulletin of the International Statistical Institute</em> 41 (3): 43–57.
</div>
<div id="ref-skinner1989analysis" class="csl-entry">
Skinner, Chris J, Daniell Holt, and Tom M F Smith. 1989. <em>Analysis of Complex Surveys</em>. New York: John Wiley &amp; Sons.
</div>
<div id="ref-Wolter_2007" class="csl-entry">
Wolter, Kirk M. 2007. <em>Introduction to Variance Estimation</em>. 2nd ed. Statistics for Social and Behavioral Sciences. Springer.
</div>
</div>
<p style="text-align: center;">
<a href="4.2-some-inferential-approaches-to-modelling-data.html"><button class="btn btn-default">Previous</button></a>
<a href="references.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
